---
title: "Initial data exploration"
date: "Oct 12, 2019"
author: "Margaret Reed, Daniel Hwang, Yi Chen"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r import-libraries}
library(tidyverse)
library(broom)
library(dplyr)
library(lubridate)
library(stringr)
library(tidytext)
library(textdata)

data(stop_words)
afinn <- get_sentiments("afinn")
```

```{r import-data}
data <- read_csv("data.csv") %>%
  tidy()
```


```{r lubridate}
data <- data %>%
  mutate(dateTime = ymd_hms(CreatedDate),
         Year = year(dateTime),
         Month = month(dateTime),
         Day = day(dateTime),
         Date = paste(Year, Month, Day, sep = "-") %>% ymd() %>% as.Date()) %>%
  select(-dateTime, -Day, -Month, -Year) %>%
  select(Date, everything())
```

```{r drop-na}
data_noNAs <- data %>%
  drop_na()
```

```{r date-viz}
data %>%
  ggplot(aes(x = Date)) +
  geom_histogram(bins = 100)
```

```{r small-data}
smallData <- data %>%
  slice(1:20)
```


```{r small-data-test}
textSmallData <- smallData %>%
  select(Date, Title, StoryID) %>%
  unnest_tokens(word, Title)

textSmallData %>%
  count(word, sort = TRUE)
```


```{r sentiment-begin}
textData <- data %>%
  select(Date, Title, StoryID) %>%
  unnest_tokens(word, Title) %>%
  anti_join(stop_words) %>%
  inner_join(afinn) %>%
  group_by(StoryID) %>%
  summarize(tot = sum(value))
```


```{r hits}
hitsSentData <- inner_join(data, textData) %>%
  select(StoryID, Hits, tot)
hitsSentData %>%
  ggplot(aes(x = tot, y = Hits)) +
  geom_point()
```

